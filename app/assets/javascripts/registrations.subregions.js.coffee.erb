
# https://github.com/jim/carmen-demo-app#readme 
subregion_change = ($country_select) ->
  select_wrapper = $('#js-registration-subregion-wrapper')
  $('select', select_wrapper).attr('disabled', true)
  country_code = $country_select.val()
  url = "/registrations/subregion_options?parent_region=#{country_code}"
  select_wrapper.load(url, ->
    if ( $('.js-registration-province').length > 1 )
      province = $('.js-registration-province').html()
      $('#user_province').val(province)
  )


init_registrations_subregions = () ->
  # change to subregion on first load
  subregion_change($('select.js-registration-country'))

  # change to subregion on country change
  $('select.js-registration-country').change (event) ->
    subregion_change($(this))

$(window).bind 'page:change', ->
  init_registrations_subregions()

$ ->
  init_registrations_subregions()

